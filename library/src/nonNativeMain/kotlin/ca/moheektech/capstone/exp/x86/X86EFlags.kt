package ca.moheektech.capstone.exp.x86

import ca.moheektech.capstone.exp.INumericEnum
import ca.moheektech.capstone.internal.*


import ca.moheektech.capstone.bit.BitField
import ca.moheektech.capstone.bit.BitFieldEnum

@ExportedApi
actual enum class X86EFlags(internal val flag: ULong) : INumericEnum {
  MODIFY_AF(X86_EFLAGS_MODIFY_AF),
  MODIFY_CF(X86_EFLAGS_MODIFY_CF),
  MODIFY_SF(X86_EFLAGS_MODIFY_SF),
  MODIFY_ZF(X86_EFLAGS_MODIFY_ZF),
  MODIFY_PF(X86_EFLAGS_MODIFY_PF),
  MODIFY_OF(X86_EFLAGS_MODIFY_OF),
  MODIFY_TF(X86_EFLAGS_MODIFY_TF),
  MODIFY_IF(X86_EFLAGS_MODIFY_IF),
  MODIFY_DF(X86_EFLAGS_MODIFY_DF),
  MODIFY_NT(X86_EFLAGS_MODIFY_NT),
  MODIFY_RF(X86_EFLAGS_MODIFY_RF),
  PRIOR_OF(X86_EFLAGS_PRIOR_OF),
  PRIOR_SF(X86_EFLAGS_PRIOR_SF),
  PRIOR_ZF(X86_EFLAGS_PRIOR_ZF),
  PRIOR_AF(X86_EFLAGS_PRIOR_AF),
  PRIOR_PF(X86_EFLAGS_PRIOR_PF),
  PRIOR_CF(X86_EFLAGS_PRIOR_CF),
  PRIOR_TF(X86_EFLAGS_PRIOR_TF),
  PRIOR_IF(X86_EFLAGS_PRIOR_IF),
  PRIOR_DF(X86_EFLAGS_PRIOR_DF),
  PRIOR_NT(X86_EFLAGS_PRIOR_NT),
  RESET_OF(X86_EFLAGS_RESET_OF),
  RESET_CF(X86_EFLAGS_RESET_CF),
  RESET_DF(X86_EFLAGS_RESET_DF),
  RESET_IF(X86_EFLAGS_RESET_IF),
  RESET_SF(X86_EFLAGS_RESET_SF),
  RESET_AF(X86_EFLAGS_RESET_AF),
  RESET_TF(X86_EFLAGS_RESET_TF),
  RESET_NT(X86_EFLAGS_RESET_NT),
  RESET_PF(X86_EFLAGS_RESET_PF),
  SET_CF(X86_EFLAGS_SET_CF),
  SET_DF(X86_EFLAGS_SET_DF),
  SET_IF(X86_EFLAGS_SET_IF),
  TEST_OF(X86_EFLAGS_TEST_OF),
  TEST_SF(X86_EFLAGS_TEST_SF),
  TEST_ZF(X86_EFLAGS_TEST_ZF),
  TEST_PF(X86_EFLAGS_TEST_PF),
  TEST_CF(X86_EFLAGS_TEST_CF),
  TEST_NT(X86_EFLAGS_TEST_NT),
  TEST_DF(X86_EFLAGS_TEST_DF),
  UNDEFINED_OF(X86_EFLAGS_UNDEFINED_OF),
  UNDEFINED_SF(X86_EFLAGS_UNDEFINED_SF),
  UNDEFINED_ZF(X86_EFLAGS_UNDEFINED_ZF),
  UNDEFINED_PF(X86_EFLAGS_UNDEFINED_PF),
  UNDEFINED_AF(X86_EFLAGS_UNDEFINED_AF),
  UNDEFINED_CF(X86_EFLAGS_UNDEFINED_CF),
  RESET_RF(X86_EFLAGS_RESET_RF),
  TEST_RF(X86_EFLAGS_TEST_RF),
  TEST_IF(X86_EFLAGS_TEST_IF),
  TEST_TF(X86_EFLAGS_TEST_TF),
  TEST_AF(X86_EFLAGS_TEST_AF),
  RESET_ZF(X86_EFLAGS_RESET_ZF),
  SET_OF(X86_EFLAGS_SET_OF),
  SET_SF(X86_EFLAGS_SET_SF),
  SET_ZF(X86_EFLAGS_SET_ZF),
  SET_AF(X86_EFLAGS_SET_AF),
  SET_PF(X86_EFLAGS_SET_PF),
  RESET_0F(X86_EFLAGS_RESET_0F),
  RESET_AC(X86_EFLAGS_RESET_AC);

    actual companion object : BitFieldEnum<X86EFlags> {
        actual override fun fromValue(value: ULong): X86EFlags? {
            return entries.firstOrNull { it.flag == value }
        }

        actual override fun allFlags(): BitField<X86EFlags> {
            return BitField.fromFlags(entries)
        }
    }

  override val value: Int
    get() = flag.toInt()
}
